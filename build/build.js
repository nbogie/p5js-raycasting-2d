"use strict";
var Agent = (function () {
    function Agent(pos) {
        this.pos = pos.copy();
        this.movementPhase = random(10000);
        this.speed = 1;
        this.ray = new Ray(this.pos, { target: mousePosAsVector() });
    }
    Agent.prototype.draw = function () {
        noStroke();
        fill("black");
        rectMode(CENTER);
        square(this.pos.x, this.pos.y, 3);
        fill(0, 20);
        this.drawAgentCanSeePosition(mousePosAsVector());
    };
    Agent.prototype.drawAgentCanSeePosition = function (targetPos) {
        var o = this.pos;
        noStroke();
        if (this.ray.canSeePoint(targetPos)) {
            fill(0, 0, 0, 20);
            circle(o.x, o.y, 8);
        }
        else {
            var distToTarget = this.pos.dist(targetPos);
            var brightness_1 = map(distToTarget, 0, max(width, height), 255, 0);
            var litColor = color(255, 255, 255, brightness_1);
            fill(litColor);
            circle(o.x, o.y, 8);
        }
    };
    Agent.prototype.setPosition = function (pos) {
        this.pos.x = pos.x;
        this.pos.y = pos.y;
    };
    Agent.createRandom = function () {
        return new Agent(randomScreenPosition());
    };
    Agent.prototype.updateWithRoaming = function (walls, targetPos) {
        var newPos = null;
        var offset = createVector(0, 0);
        offset.x = map(noise(this.movementPhase + 33333 + frameCount / 100), 0, 1, -1, 1);
        offset.y = map(noise(this.movementPhase + frameCount / 100), 0, 1, -1, 1);
        var attractVec = this.pos
            .copy()
            .sub(targetPos)
            .normalize();
        newPos = this.pos.copy().add(attractVec.mult(this.speed));
        newPos.add(offset);
        this.setPosition(newPos);
        this.ray = new Ray(this.pos, { target: targetPos });
        this.ray.recalculateIntersections(walls);
        var newSpeed = this.speed + (this.ray.canSeePoint(targetPos) ? -0.1 : 0.1);
        if (Math.abs(newSpeed) < 3) {
            this.speed = newSpeed;
        }
    };
    return Agent;
}());
var Particle = (function () {
    function Particle(pos) {
        this.pos = pos.copy();
    }
    Particle.prototype.draw = function () {
        noStroke();
        fill("black");
        rectMode(CENTER);
        square(this.pos.x, this.pos.y, 3);
        fill(0, 20);
    };
    Particle.prototype.update = function () { };
    Particle.prototype.setPosition = function (pos) {
        this.pos.x = pos.x;
        this.pos.y = pos.y;
    };
    Particle.createRandom = function () {
        return new Particle(randomScreenPosition());
    };
    return Particle;
}());
var Ray = (function () {
    function Ray(origin, _a) {
        var _b = _a.angleRads, angleRads = _b === void 0 ? null : _b, _c = _a.target, target = _c === void 0 ? null : _c, _d = _a.walls, walls = _d === void 0 ? [] : _d;
        this.origin = origin.copy();
        if (target !== null) {
            this.lookAt(target);
        }
        else {
            this.angleRads = p5.Vector.fromAngle(angleRads);
        }
        this.intersectionPoints = [];
        this.recalculateFarEnd();
        if (walls.length > 0) {
            this.recalculateIntersections(walls);
        }
    }
    Ray.prototype.lookAt = function (targetPos) {
        var deltaToTarget = targetPos.copy().sub(this.origin);
        var angleToTarget = atan2(deltaToTarget.y, deltaToTarget.x);
        this.angleRads = p5.Vector.fromAngle(angleToTarget);
        this.recalculateFarEnd();
    };
    Ray.createRandom = function () {
        return new Ray(randomScreenPosition(), { angleRads: random(0, TWO_PI) });
    };
    Ray.prototype.intersectionWithWall = function (wall) {
        var answer = collideLineLine(wall.a.x, wall.a.y, wall.b.x, wall.b.y, this.origin.x, this.origin.y, this.farEnd.x, this.farEnd.y);
        return answer;
    };
    Ray.prototype.nearestIntersection = function () {
        var _this = this;
        if (this.intersectionPoints.length > 0) {
            return minBy(this.intersectionPoints, function (pt) { return -_this.origin.dist(pt); });
        }
        else {
            return undefined;
        }
    };
    Ray.prototype.calculateIntersections = function (walls) {
        var res = [];
        for (var _i = 0, walls_1 = walls; _i < walls_1.length; _i++) {
            var wall = walls_1[_i];
            var intersection = this.intersectionWithWall(wall);
            if (intersection) {
                res.push(intersection);
            }
        }
        return res;
    };
    Ray.prototype.recalculateIntersections = function (walls) {
        this.intersectionPoints = this.calculateIntersections(walls);
    };
    Ray.prototype.recalculateFarEnd = function () {
        this.farEnd = this.origin.copy().add(this.angleRads.copy().mult(width));
    };
    Ray.prototype.drawLitLineSegment = function (a, b) {
        if (Ray.isRenderAsCobweb) {
            for (var i = 0; i < 20; i++) {
                var pt = a.copy().lerp(b, i / 10);
                square(pt.x, pt.y, 1);
            }
        }
        else {
            line(a.x, a.y, b.x, b.y);
        }
    };
    Ray.prototype.drawRayUntilFirstIntersection = function () {
        var o = this.origin;
        var end = o.copy().add(this.angleRads.copy().mult(40));
        if (Ray.isDrawGhostRay) {
            stroke(255, 255, 255, 10);
            strokeWeight(0.3);
            line(o.x, o.y, this.farEnd.x, this.farEnd.y);
        }
        var nearPt = this.nearestIntersection();
        if (Ray.isDrawRayToFirstIntersection) {
            if (nearPt) {
                stroke("white");
                strokeWeight(2);
                this.drawLitLineSegment(o, nearPt);
            }
        }
        if (Ray.isDrawIntersections) {
            for (var _i = 0, _a = this.intersectionPoints; _i < _a.length; _i++) {
                var iPt = _a[_i];
                fill("gray");
                circle(iPt.x, iPt.y, 2);
            }
            var first = this.nearestIntersection();
            if (first) {
                fill("white");
                circle(first.x, first.y, 2);
            }
        }
    };
    Ray.prototype.canSeePoint = function (target) {
        var nearestIsect = this.nearestIntersection();
        var distToTarget = this.origin.dist(target);
        return nearestIsect && this.origin.dist(nearestIsect) < distToTarget;
    };
    Ray.isRenderAsCobweb = false;
    Ray.isDrawGhostRay = true;
    Ray.isDrawRayToFirstIntersection = true;
    Ray.isDrawIntersections = false;
    return Ray;
}());
var Structure = (function () {
    function Structure(center, radius, numSides) {
        this.isFilledShape = false;
        this.rotation = random(TWO_PI);
        this.myColor = this.randomColor();
        this.movementSpeed = -random(0.2, 2);
        this.rotationSpeed = random(-0.01, 0.01);
        this.abstractVertices = this.createVerticesForShapeWithNumSides(center, radius, numSides);
        this.walls = this.makeWallsFromVertices(this.abstractVertices, this.myColor);
    }
    Structure.prototype.randomColor = function () {
        return random([
            color(250, 105, 0),
            color(105, 210, 231),
            color(167, 219, 216),
            color(243, 134, 48)
        ]);
    };
    Structure.prototype.createVerticesForShapeWithNumSides = function (center, radius, numSides) {
        var vertices = [];
        if (numSides === 1) {
            var _a = this.createRandomLineSeg(), a = _a[0], b = _a[1];
            vertices.push(a);
            vertices.push(b);
            this.center = a.copy().lerp(b, 0.5);
        }
        else {
            this.center = center.copy();
            for (var i = 0; i < numSides; i++) {
                var angle = (i * TWO_PI) / numSides;
                vertices.push(p5.Vector.fromAngle(angle)
                    .mult(radius)
                    .add(this.center));
            }
        }
        return vertices;
    };
    Structure.prototype.makeWallsFromVertices = function (vs, myColor) {
        var walls = [];
        if (vs.length === 2) {
            var singleWall = new Wall(vs[0], vs[1]);
            singleWall.myColor = myColor;
            walls.push(singleWall);
        }
        else {
            var numSides = vs.length;
            for (var i = 0; i < numSides; i++) {
                var a = vs[i];
                var b = i === numSides - 1 ? vs[0] : vs[i + 1];
                var wall = new Wall(a, b);
                wall.myColor = myColor;
                walls.push(wall);
            }
        }
        return walls;
    };
    Structure.prototype.createRandomLineSeg = function () {
        var p1 = randomScreenPosition();
        var p2 = p1.copy().add(p5.Vector.random2D().mult(random(40, 400)));
        return [p1, p2];
    };
    Structure.prototype.rotate = function (angleRad) {
        var _this = this;
        this.rotation += angleRad;
        var rotatedVertices = this.abstractVertices.map(function (v) {
            return rotateVertexAround(v, _this.center, _this.rotation);
        });
        this.walls = this.makeWallsFromVertices(rotatedVertices, this.myColor);
    };
    Structure.prototype.update = function () {
        var moveAmt = this.movementSpeed;
        if (this.center.x + moveAmt < 0) {
            moveAmt += width;
        }
        this.center.x += moveAmt;
        this.walls = this.makeWallsFromVertices(this.abstractVertices.map(function (v) { return v.add(createVector(moveAmt, 0)); }), this.myColor);
        this.rotate(this.rotationSpeed);
    };
    Structure.prototype.draw = function () {
        for (var _i = 0, _a = this.walls; _i < _a.length; _i++) {
            var wall = _a[_i];
            wall.draw();
        }
        circle(this.center.x, this.center.y, 5);
        if (this.isFilledShape) {
            beginShape();
            for (var _b = 0, _c = this.walls; _b < _c.length; _b++) {
                var wall = _c[_b];
                for (var _d = 0, _e = [wall.a, wall.b]; _d < _e.length; _d++) {
                    var pt = _e[_d];
                    vertex(pt.x, pt.y);
                }
            }
            endShape(CLOSE);
        }
    };
    Structure.createRandom = function () {
        var center = randomScreenPosition();
        var numSides = random([1, 1, 1, 3, 4, 5, 8]);
        return new Structure(center, random(20, random(100, 200)), numSides);
    };
    return Structure;
}());
function repeat(num, fn) {
    for (var i = 0; i < num; i++) {
        fn(i);
    }
}
function randomScreenPosition() {
    return createVector(random(width), random(height));
}
function randomInt(min, max) {
    return round(random(min, max));
}
function translateToVec(pos) {
    translate(pos.x, pos.y);
}
function centerPos() {
    return createVector(width / 2, height / 2);
}
function rotateVertexAround(vertex, rotOrigin, angleRad) {
    return vertex
        .copy()
        .sub(rotOrigin)
        .rotate(angleRad)
        .add(rotOrigin);
}
function collideLineLine(x1, y1, x2, y2, x3, y3, x4, y4) {
    var uA = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) /
        ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1));
    var uB = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) /
        ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1));
    if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {
        var intersectionX = x1 + uA * (x2 - x1);
        var intersectionY = y1 + uA * (y2 - y1);
        return createVector(intersectionX, intersectionY);
    }
    return null;
}
function minBy(list, fn) {
    if (list.length < 0) {
        return null;
    }
    var recordItem = list[0];
    var recordWeight = fn(list[0]);
    for (var _i = 0, list_1 = list; _i < list_1.length; _i++) {
        var item = list_1[_i];
        var weight = fn(item);
        if (weight > recordWeight) {
            recordWeight = weight;
            recordItem = item;
        }
    }
    return recordItem;
}
function distributeUpTo(total, max, fn) {
    repeat(total, function (ix) {
        var val = (ix * max) / total;
        fn(val);
    });
}
var Wall = (function () {
    function Wall(a, b) {
        this.a = a.copy();
        this.b = b.copy();
        this.myColor = color(243, 134, 48);
    }
    Wall.prototype.draw = function () {
        stroke(this.myColor);
        strokeWeight(4);
        line(this.a.x, this.a.y, this.b.x, this.b.y);
        noStroke();
        fill(this.myColor);
        [this.a, this.b].forEach(function (pt) {
            circle(pt.x, pt.y, 5);
        });
    };
    Wall.prototype.midPoint = function () {
        return this.a.copy().lerp(this.b, 0.5);
    };
    Wall.prototype.length = function () {
        return dist(this.a.x, this.a.y, this.b.x, this.b.y);
    };
    Wall.prototype.translate = function (offset) {
        for (var _i = 0, _a = [this.a, this.b]; _i < _a.length; _i++) {
            var pt = _a[_i];
            pt.x += offset.x;
            pt.y += offset.y;
        }
    };
    Wall.createRandom = function () {
        var p1 = randomScreenPosition();
        var p2 = p1.copy().add(p5.Vector.random2D().mult(random(40, 400)));
        return new Wall(p1, p2);
    };
    return Wall;
}());
p5.disableFriendlyErrors = true;
var isDebugging = false;
var gAgents = [];
var gPlayerRays = [];
var gPlayer = null;
var gNumWalls = 20;
var gNumAgents = 100;
var gNumPlayerRays = 100;
var gNumStructures = 30;
var gStructures = [];
function setup() {
    createCanvas(windowWidth, windowHeight);
    repeat(gNumStructures, function () {
        var structure = Structure.createRandom();
        gStructures.push(structure);
    });
    repeat(gNumAgents, function () {
        gAgents.push(Agent.createRandom());
    });
    gPlayerRays = createRaysAtPosition(gNumPlayerRays, mousePosAsVector());
    gPlayer = Particle.createRandom();
    mouseX = centerPos().x;
    mouseY = centerPos().y;
}
function getAllWalls() {
    return gStructures.flatMap(function (structure) { return structure.walls; });
}
function createRaysAtPosition(numRays, pos) {
    var rays = [];
    distributeUpTo(numRays, TWO_PI, function (val) {
        return rays.push(new Ray(pos, { angleRads: val, walls: getAllWalls() }));
    });
    return rays;
}
function mousePosAsVector() {
    return createVector(mouseX, mouseY);
}
function update() {
    gPlayer.setPosition(mousePosAsVector());
    gPlayer.update();
    for (var _i = 0, gStructures_1 = gStructures; _i < gStructures_1.length; _i++) {
        var s = gStructures_1[_i];
        s.update();
    }
    for (var _a = 0, gAgents_1 = gAgents; _a < gAgents_1.length; _a++) {
        var agent = gAgents_1[_a];
        agent.updateWithRoaming(getAllWalls(), mousePosAsVector());
    }
    gPlayerRays = createRaysAtPosition(gNumPlayerRays, mousePosAsVector());
}
function draw() {
    update();
    background(0);
    fill("black");
    noStroke();
    for (var _i = 0, gStructures_2 = gStructures; _i < gStructures_2.length; _i++) {
        var s = gStructures_2[_i];
        s.draw();
    }
    for (var _a = 0, _b = getAllWalls(); _a < _b.length; _a++) {
        var wall = _b[_a];
        wall.draw();
    }
    for (var _c = 0, gAgents_2 = gAgents; _c < gAgents_2.length; _c++) {
        var agent = gAgents_2[_c];
        agent.draw();
    }
    for (var _d = 0, gPlayerRays_1 = gPlayerRays; _d < gPlayerRays_1.length; _d++) {
        var ray = gPlayerRays_1[_d];
        ray.drawRayUntilFirstIntersection();
    }
    gPlayer.draw();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGQuanMiLCJzb3VyY2VSb290IjoiLi9qcy8iLCJzb3VyY2VzIjpbImluZGV4LnRzIiwiQWdlbnQudHMiLCJQYXJ0aWNsZS50cyIsIlJheS50cyIsIlN0cnVjdHVyZS50cyIsIlV0aWxzLnRzIiwiV2FsbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7QUNBYjtJQU1FLGVBQVksR0FBYztRQUN4QixJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN0QixJQUFJLENBQUMsYUFBYSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNuQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztRQUNmLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLE1BQU0sRUFBRSxnQkFBZ0IsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUMvRCxDQUFDO0lBRUQsb0JBQUksR0FBSjtRQUNFLFFBQVEsRUFBRSxDQUFDO1FBQ1gsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2QsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2pCLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNsQyxJQUFJLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBRVosSUFBSSxDQUFDLHVCQUF1QixDQUFDLGdCQUFnQixFQUFFLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBRUQsdUNBQXVCLEdBQXZCLFVBQXdCLFNBQW9CO1FBQzFDLElBQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUM7UUFHbkIsUUFBUSxFQUFFLENBQUM7UUFDWCxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQ25DLElBQUks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QU0sRUFBRSxDQUFDO0lBQ1QsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ2QsUUFBUSxFQUFFLENBQUM7SUFFWCxLQUFjLFVBQVcsRUFBWCwyQkFBVyxFQUFYLHlCQUFXLEVBQVgsSUFBVyxFQUFFO1FBQXRCLElBQUksQ0FBQyxvQkFBQTtRQUNSLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztLQUNWO0lBQ0QsS0FBaUIsVUFBYSxFQUFiLEtBQUEsV0FBVyxFQUFFLEVBQWIsY0FBYSxFQUFiLElBQWEsRUFBRTtRQUEzQixJQUFJLElBQUksU0FBQTtRQUNYLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztLQUNiO0lBQ0QsS0FBa0IsVUFBTyxFQUFQLG1CQUFPLEVBQVAscUJBQU8sRUFBUCxJQUFPLEVBQUU7UUFBdEIsSUFBSSxLQUFLLGdCQUFBO1FBQ1osS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO0tBQ2Q7SUFDRCxLQUFnQixVQUFXLEVBQVgsMkJBQVcsRUFBWCx5QkFBVyxFQUFYLElBQVcsRUFBRTtRQUF4QixJQUFJLEdBQUcsb0JBQUE7UUFDVixHQUFHLENBQUMsNkJBQTZCLEVBQUUsQ0FBQztLQUNyQztJQUNELE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNqQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbnA1LmRpc2FibGVGcmllbmRseUVycm9ycyA9IHRydWU7XG5jb25zdCBpc0RlYnVnZ2luZyA9IGZhbHNlO1xubGV0IGdBZ2VudHM6IEFnZW50W10gPSBbXTtcbmxldCBnUGxheWVyUmF5czogUmF5W10gPSBbXTtcbmxldCBnUGxheWVyOiBQYXJ0aWNsZSA9IG51bGw7XG5sZXQgZ051bVdhbGxzOiBudW1iZXIgPSAyMDtcbmxldCBnTnVtQWdlbnRzOiBudW1iZXIgPSAxMDA7XG5sZXQgZ051bVBsYXllclJheXM6IG51bWJlciA9IDEwMDtcbmxldCBnTnVtU3RydWN0dXJlcyA9IDMwO1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBTRVRVUFxuICovXG5jb25zdCBnU3RydWN0dXJlczogU3RydWN0dXJlW10gPSBbXTtcbmZ1bmN0aW9uIHNldHVwKCkge1xuICBjcmVhdGVDYW52YXMod2luZG93V2lkdGgsIHdpbmRvd0hlaWdodCk7XG5cbiAgcmVwZWF0KGdOdW1TdHJ1Y3R1cmVzLCAoKSA9PiB7XG4gICAgY29uc3Qgc3RydWN0dXJlID0gU3RydWN0dXJlLmNyZWF0ZVJhbmRvbSgpO1xuICAgIGdTdHJ1Y3R1cmVzLnB1c2goc3RydWN0dXJlKTtcbiAgfSk7XG5cbiAgcmVwZWF0KGdOdW1BZ2VudHMsICgpID0+IHtcbiAgICBnQWdlbnRzLnB1c2goQWdlbnQuY3JlYXRlUmFuZG9tKCkpO1xuICB9KTtcblxuICBnUGxheWVyUmF5cyA9IGNyZWF0ZVJheXNBdFBvc2l0aW9uKGdOdW1QbGF5ZXJSYXlzLCBtb3VzZVBvc0FzVmVjdG9yKCkpO1xuXG4gIGdQbGF5ZXIgPSBQYXJ0aWNsZS5jcmVhdGVSYW5kb20oKTtcbiAgbW91c2VYID0gY2VudGVyUG9zKCkueDtcbiAgbW91c2VZID0gY2VudGVyUG9zKCkueTtcbn1cblxuZnVuY3Rpb24gZ2V0QWxsV2FsbHMoKTogV2FsbFtdIHtcbiAgcmV0dXJuIGdTdHJ1Y3R1cmVzLmZsYXRNYXAoKHN0cnVjdHVyZTogU3RydWN0dXJlKSA9PiBzdHJ1Y3R1cmUud2FsbHMpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVSYXlzQXRQb3NpdGlvbihudW1SYXlzOiBudW1iZXIsIHBvczogcDUuVmVjdG9yKSB7XG4gIGNvbnN0IHJheXM6IFJheVtdID0gW107XG4gIGRpc3RyaWJ1dGVVcFRvKG51bVJheXMsIFRXT19QSSwgdmFsID0+XG4gICAgcmF5cy5wdXNoKG5ldyBSYXkocG9zLCB7IGFuZ2xlUmFkczogdmFsLCB3YWxsczogZ2V0QWxsV2FsbHMoKSB9KSlcbiAgKTtcbiAgcmV0dXJuIHJheXM7XG59XG5cbmZ1bmN0aW9uIG1vdXNlUG9zQXNWZWN0b3IoKSB7XG4gIHJldHVybiBjcmVhdGVWZWN0b3IobW91c2VYLCBtb3VzZVkpO1xufVxuZnVuY3Rpb24gdXBkYXRlKCkge1xuICBnUGxheWVyLnNldFBvc2l0aW9uKG1vdXNlUG9zQXNWZWN0b3IoKSk7XG4gIGdQbGF5ZXIudXBkYXRlKCk7XG5cbiAgZm9yIChsZXQgcyBvZiBnU3RydWN0dXJlcykge1xuICAgIHMudXBkYXRlKCk7XG4gIH1cbiAgZm9yIChsZXQgYWdlbnQgb2YgZ0FnZW50cykge1xuICAgIGFnZW50LnVwZGF0ZVdpdGhSb2FtaW5nKGdldEFsbFdhbGxzKCksIG1vdXNlUG9zQXNWZWN0b3IoKSk7XG4gIH1cblxuICBnUGxheWVyUmF5cyA9IGNyZWF0ZVJheXNBdFBvc2l0aW9uKGdOdW1QbGF5ZXJSYXlzLCBtb3VzZVBvc0FzVmVjdG9yKCkpO1xufVxuLypcbiAqIERSQVdcbiAqL1xuZnVuY3Rpb24gZHJhdygpIHtcbiAgdXBkYXRlKCk7XG4gIGJhY2tncm91bmQoMCk7XG4gIGZpbGwoXCJibGFja1wiKTtcbiAgbm9TdHJva2UoKTtcblxuICBmb3IgKGxldCBzIG9mIGdTdHJ1Y3R1cmVzKSB7XG4gICAgcy5kcmF3KCk7XG4gIH1cbiAgZm9yIChsZXQgd2FsbCBvZiBnZXRBbGxXYWxscygpKSB7XG4gICAgd2FsbC5kcmF3KCk7XG4gIH1cbiAgZm9yIChsZXQgYWdlbnQgb2YgZ0FnZW50cykge1xuICAgIGFnZW50LmRyYXcoKTtcbiAgfVxuICBmb3IgKGxldCByYXkgb2YgZ1BsYXllclJheXMpIHtcbiAgICByYXkuZHJhd1JheVVudGlsRmlyc3RJbnRlcnNlY3Rpb24oKTtcbiAgfVxuICBnUGxheWVyLmRyYXcoKTtcbn1cbiIsImNsYXNzIEFnZW50IHtcbiAgcG9zOiBwNS5WZWN0b3I7XG4gIG1vdmVtZW50UGhhc2U6IG51bWJlcjtcbiAgc3BlZWQ6IG51bWJlcjtcbiAgcmF5OiBSYXk7XG5cbiAgY29uc3RydWN0b3IocG9zOiBwNS5WZWN0b3IpIHtcbiAgICB0aGlzLnBvcyA9IHBvcy5jb3B5KCk7XG4gICAgdGhpcy5tb3ZlbWVudFBoYXNlID0gcmFuZG9tKDEwMDAwKTtcbiAgICB0aGlzLnNwZWVkID0gMTtcbiAgICB0aGlzLnJheSA9IG5ldyBSYXkodGhpcy5wb3MsIHsgdGFyZ2V0OiBtb3VzZVBvc0FzVmVjdG9yKCkgfSk7XG4gIH1cblxuICBkcmF3KCkge1xuICAgIG5vU3Ryb2tlKCk7XG4gICAgZmlsbChcImJsYWNrXCIpO1xuICAgIHJlY3RNb2RlKENFTlRFUik7XG4gICAgc3F1YXJlKHRoaXMucG9zLngsIHRoaXMucG9zLnksIDMpO1xuICAgIGZpbGwoMCwgMjApO1xuXG4gICAgdGhpcy5kcmF3QWdlbnRDYW5TZWVQb3NpdGlvbihtb3VzZVBvc0FzVmVjdG9yKCkpO1xuICB9XG5cbiAgZHJhd0FnZW50Q2FuU2VlUG9zaXRpb24odGFyZ2V0UG9zOiBwNS5WZWN0b3IpIHtcbiAgICBjb25zdCBvID0gdGhpcy5wb3M7XG5cbiAgICAvL2RyYXcgYWdlbnQgc3ByaXRlIChhIGNpcmNsZSkgYWNjb3JkaW5nIHRvIHdoZXRoZXIgaXQgaGFzIGwuby5zLiB0byB0YXJnZXRQb3NcbiAgICBub1N0cm9rZSgpO1xuICAgIGlmICh0aGlzLnJheS5jYW5TZWVQb2ludCh0YXJnZXRQb3MpKSB7XG4gICAgICBmaWxsKDAsIDAsIDAsIDIwKTtcbiAgICAgIGNpcmNsZShvLngsIG8ueSwgOCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGRpc3RUb1RhcmdldCA9IHRoaXMucG9zLmRpc3QodGFyZ2V0UG9zKTtcbiAgICAgIGNvbnN0IGJyaWdodG5lc3MgPSBtYXAoZGlzdFRvVGFyZ2V0LCAwLCBtYXgod2lkdGgsIGhlaWdodCksIDI1NSwgMCk7XG4gICAgICBjb25zdCBsaXRDb2xvcjogcDUuQ29sb3IgPSBjb2xvcigyNTUsIDI1NSwgMjU1LCBicmlnaHRuZXNzKTtcbiAgICAgIGZpbGwobGl0Q29sb3IpO1xuICAgICAgY2lyY2xlKG8ueCwgby55LCA4KTtcbiAgICB9XG4gIH1cblxuICBzZXRQb3NpdGlvbihwb3M6IHA1LlZlY3Rvcikge1xuICAgIHRoaXMucG9zLnggPSBwb3MueDtcbiAgICB0aGlzLnBvcy55ID0gcG9zLnk7XG4gIH1cblxuICBzdGF0aWMgY3JlYXRlUmFuZG9tKCkge1xuICAgIHJldHVybiBuZXcgQWdlbnQocmFuZG9tU2NyZWVuUG9zaXRpb24oKSk7XG4gIH1cblxuICB1cGRhdGVXaXRoUm9hbWluZyh3YWxsczogV2FsbFtdLCB0YXJnZXRQb3M6IHA1LlZlY3Rvcik6IHZvaWQge1xuICAgIGxldCBuZXdQb3M6IHA1LlZlY3RvciA9IG51bGw7XG5cbiAgICBjb25zdCBvZmZzZXQgPSBjcmVhdGVWZWN0b3IoMCwgMCk7XG4gICAgb2Zmc2V0LnggPSBtYXAoXG4gICAgICBub2lzZSh0aGlzLm1vdmVtZW50UGhhc2UgKyAzMzMzMyArIGZyYW1lQ291bnQgLyAxMDApLFxuICAgICAgMCxcbiAgICAgIDEsXG4gICAgICAtMSxcbiAgICAgIDFcbiAgICApO1xuICAgIG9mZnNldC55ID0gbWFwKG5vaXNlKHRoaXMubW92ZW1lbnRQaGFzZSArIGZyYW1lQ291bnQgLyAxMDApLCAwLCAxLCAtMSwgMSk7XG5cbiAgICBjb25zdCBhdHRyYWN0VmVjID0gdGhpcy5wb3NcbiAgICAgIC5jb3B5KClcbiAgICAgIC5zdWIodGFyZ2V0UG9zKVxuICAgICAgLm5vcm1hbGl6ZSgpO1xuICAgIG5ld1BvcyA9IHRoaXMucG9zLmNvcHkoKS5hZGQoYXR0cmFjdFZlYy5tdWx0KHRoaXMuc3BlZWQpKTtcblxuICAgIG5ld1Bvcy5hZGQob2Zmc2V0KTtcblxuICAgIHRoaXMuc2V0UG9zaXRpb24obmV3UG9zKTtcbiAgICB0aGlzLnJheSA9IG5ldyBSYXkodGhpcy5wb3MsIHsgdGFyZ2V0OiB0YXJnZXRQb3MgfSk7XG4gICAgdGhpcy5yYXkucmVjYWxjdWxhdGVJbnRlcnNlY3Rpb25zKHdhbGxzKTtcblxuICAgIGNvbnN0IG5ld1NwZWVkID1cbiAgICAgIHRoaXMuc3BlZWQgKyAodGhpcy5yYXkuY2FuU2VlUG9pbnQodGFyZ2V0UG9zKSA/IC0wLjEgOiAwLjEpO1xuICAgIGlmIChNYXRoLmFicyhuZXdTcGVlZCkgPCAzKSB7XG4gICAgICB0aGlzLnNwZWVkID0gbmV3U3BlZWQ7XG4gICAgfVxuICB9XG59XG4iLCJjbGFzcyBQYXJ0aWNsZSB7XG4gIHBvczogcDUuVmVjdG9yO1xuXG4gIGNvbnN0cnVjdG9yKHBvczogcDUuVmVjdG9yKSB7XG4gICAgdGhpcy5wb3MgPSBwb3MuY29weSgpO1xuICB9XG4gIGRyYXcoKSB7XG4gICAgbm9TdHJva2UoKTtcbiAgICBmaWxsKFwiYmxhY2tcIik7XG4gICAgcmVjdE1vZGUoQ0VOVEVSKTtcbiAgICBzcXVhcmUodGhpcy5wb3MueCwgdGhpcy5wb3MueSwgMyk7XG4gICAgZmlsbCgwLCAyMCk7XG4gIH1cbiAgdXBkYXRlKCkge31cblxuICBzZXRQb3NpdGlvbihwb3M6IHA1LlZlY3Rvcikge1xuICAgIHRoaXMucG9zLnggPSBwb3MueDtcbiAgICB0aGlzLnBvcy55ID0gcG9zLnk7XG4gIH1cblxuICBzdGF0aWMgY3JlYXRlUmFuZG9tKCkge1xuICAgIHJldHVybiBuZXcgUGFydGljbGUocmFuZG9tU2NyZWVuUG9zaXRpb24oKSk7XG4gIH1cbn1cbiIsImludGVyZmFjZSBSYXlPcHRpb25zIHtcbiAgYW5nbGVSYWRzPzogbnVtYmVyO1xuICB0YXJnZXQ/OiBwNS5WZWN0b3I7IC8vVE9ETzogZXhhY3RseSBvbmUgb2YgdGFyZ2V0IGFuZCBhbmdsZVJhZHMgaXMgcmVxdWlyZWQuXG4gIHdhbGxzPzogV2FsbFtdO1xufVxuY2xhc3MgUmF5IHtcbiAgLy9UT0RPOiBzcGxpdCB0aGlzIG91dCBpbnRvIGFuIGFnZW50IHdoaWNoIGhhcyBhbiBvcmlnaW4gYW5kIGEgcmF5LCB3aXRoIHRoZSByYXkgaGFuZGxpbmcgb25seSBoYW5kbGluZyBkZWNpZGluZyBsaW5lIG9mIHNpZ2h0IGFuZCBpbnRlcnNlY3Rpb24gcG9pbnRzLlxuICBzdGF0aWMgaXNSZW5kZXJBc0NvYndlYiA9IGZhbHNlO1xuICBzdGF0aWMgaXNEcmF3R2hvc3RSYXk6IGJvb2xlYW4gPSB0cnVlO1xuICBzdGF0aWMgaXNEcmF3UmF5VG9GaXJzdEludGVyc2VjdGlvbjogYm9vbGVhbiA9IHRydWU7XG4gIHN0YXRpYyBpc0RyYXdJbnRlcnNlY3Rpb25zOiBib29sZWFuID0gZmFsc2U7XG5cbiAgb3JpZ2luOiBwNS5WZWN0b3I7XG5cbiAgLy9yYXkgaXMgY29uY2VwdHVhbGx5IGluZmluaXRlIGxlbmd0aCB3aXRoIG9ubHkgb25lIGVuZCwgYnV0IHRoaXMgaGFjayBpcyB1c2VmdWwgZm9yIGludGVyc2VjdGlvbiBhbmQgcmVuZGVyaW5nLlxuICBmYXJFbmQ6IHA1LlZlY3RvcjsgLy9hIGhhY2suICBvZmZzY3JlZW4gXCJmYXIgZW5kXCIuXG5cbiAgYW5nbGVSYWRzOiBwNS5WZWN0b3I7XG4gIGludGVyc2VjdGlvblBvaW50czogcDUuVmVjdG9yW107XG5cbiAgY29uc3RydWN0b3IoXG4gICAgb3JpZ2luOiBwNS5WZWN0b3IsXG4gICAgeyBhbmdsZVJhZHMgPSBudWxsLCB0YXJnZXQgPSBudWxsLCB3YWxscyA9IFtdIH06IFJheU9wdGlvbnNcbiAgKSB7XG4gICAgdGhpcy5vcmlnaW4gPSBvcmlnaW4uY29weSgpO1xuICAgIGlmICh0YXJnZXQgIT09IG51bGwpIHtcbiAgICAgIHRoaXMubG9va0F0KHRhcmdldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYW5nbGVSYWRzID0gcDUuVmVjdG9yLmZyb21BbmdsZShhbmdsZVJhZHMpO1xuICAgIH1cbiAgICB0aGlzLmludGVyc2VjdGlvblBvaW50cyA9IFtdO1xuICAgIHRoaXMucmVjYWxjdWxhdGVGYXJFbmQoKTtcbiAgICBpZiAod2FsbHMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5yZWNhbGN1bGF0ZUludGVyc2VjdGlvbnMod2FsbHMpO1xuICAgIH1cbiAgfVxuXG4gIGxvb2tBdCh0YXJnZXRQb3M6IHA1LlZlY3Rvcik6IHZvaWQge1xuICAgIGNvbnN0IGRlbHRhVG9UYXJnZXQgPSB0YXJnZXRQb3MuY29weSgpLnN1Yih0aGlzLm9yaWdpbik7XG4gICAgLy9ub3RlOiBwYXJhbSBvcmRlcjogeSB0aGVuIHhcbiAgICBjb25zdCBhbmdsZVRvVGFyZ2V0ID0gYXRhbjIoZGVsdGFUb1RhcmdldC55LCBkZWx0YVRvVGFyZ2V0LngpO1xuICAgIHRoaXMuYW5nbGVSYWRzID0gcDUuVmVjdG9yLmZyb21BbmdsZShhbmdsZVRvVGFyZ2V0KTtcbiAgICB0aGlzLnJlY2FsY3VsYXRlRmFyRW5kKCk7XG4gIH1cblxuICBzdGF0aWMgY3JlYXRlUmFuZG9tKCk6IFJheSB7XG4gICAgcmV0dXJuIG5ldyBSYXkocmFuZG9tU2NyZWVuUG9zaXRpb24oKSwgeyBhbmdsZVJhZHM6IHJhbmRvbSgwLCBUV09fUEkpIH0pO1xuICB9XG4gIGludGVyc2VjdGlvbldpdGhXYWxsKHdhbGw6IFdhbGwpOiBwNS5WZWN0b3Ige1xuICAgIC8vVE9ETzogY3VzdG9taXNlIGEgZm4gdG8gY29sbGlkZUxpbmVTZWdXaXRoUmF5LFxuICAgIC8vcmF0aGVyIHRoYW4gTGluZVNlZyB3aXRoIExpbmVTZWdcbiAgICBjb25zdCBhbnN3ZXIgPSBjb2xsaWRlTGluZUxpbmUoXG4gICAgICB3YWxsLmEueCxcbiAgICAgIHdhbGwuYS55LFxuICAgICAgd2FsbC5iLngsXG4gICAgICB3YWxsLmIueSxcbiAgICAgIHRoaXMub3JpZ2luLngsXG4gICAgICB0aGlzLm9yaWdpbi55LFxuICAgICAgdGhpcy5mYXJFbmQueCxcbiAgICAgIHRoaXMuZmFyRW5kLnlcbiAgICApO1xuXG4gICAgcmV0dXJuIGFuc3dlcjtcbiAgfVxuXG4gIG5lYXJlc3RJbnRlcnNlY3Rpb24oKTogcDUuVmVjdG9yIHtcbiAgICBpZiAodGhpcy5pbnRlcnNlY3Rpb25Qb2ludHMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIG1pbkJ5KFxuICAgICAgICB0aGlzLmludGVyc2VjdGlvblBvaW50cyxcbiAgICAgICAgKHB0OiBwNS5WZWN0b3IpID0+IC10aGlzLm9yaWdpbi5kaXN0KHB0KVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cbiAgY2FsY3VsYXRlSW50ZXJzZWN0aW9ucyh3YWxsczogV2FsbFtdKTogcDUuVmVjdG9yW10ge1xuICAgIGNvbnN0IHJlczogcDUuVmVjdG9yW10gPSBbXTtcbiAgICBmb3IgKGxldCB3YWxsIG9mIHdhbGxzKSB7XG4gICAgICBjb25zdCBpbnRlcnNlY3Rpb24gPSB0aGlzLmludGVyc2VjdGlvbldpdGhXYWxsKHdhbGwpO1xuICAgICAgaWYgKGludGVyc2VjdGlvbikge1xuICAgICAgICByZXMucHVzaChpbnRlcnNlY3Rpb24pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzO1xuICB9XG4gIHJlY2FsY3VsYXRlSW50ZXJzZWN0aW9ucyh3YWxsczogV2FsbFtdKTogdm9pZCB7XG4gICAgdGhpcy5pbnRlcnNlY3Rpb25Qb2ludHMgPSB0aGlzLmNhbGN1bGF0ZUludGVyc2VjdGlvbnMod2FsbHMpO1xuICB9XG5cbiAgcmVjYWxjdWxhdGVGYXJFbmQoKTogdm9pZCB7XG4gICAgdGhpcy5mYXJFbmQgPSB0aGlzLm9yaWdpbi5jb3B5KCkuYWRkKHRoaXMuYW5nbGVSYWRzLmNvcHkoKS5tdWx0KHdpZHRoKSk7XG4gIH1cblxuICBkcmF3TGl0TGluZVNlZ21lbnQoYTogcDUuVmVjdG9yLCBiOiBwNS5WZWN0b3IpOiB2b2lkIHtcbiAgICBpZiAoUmF5LmlzUmVuZGVyQXNDb2J3ZWIpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkrKykge1xuICAgICAgICBjb25zdCBwdCA9IGEuY29weSgpLmxlcnAoYiwgaSAvIDEwKTtcbiAgICAgICAgc3F1YXJlKHB0LngsIHB0LnksIDEpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBsaW5lKGEueCwgYS55LCBiLngsIGIueSk7XG4gICAgfVxuICB9XG5cbiAgZHJhd1JheVVudGlsRmlyc3RJbnRlcnNlY3Rpb24oKTogdm9pZCB7XG4gICAgY29uc3QgbyA9IHRoaXMub3JpZ2luO1xuICAgIGNvbnN0IGVuZCA9IG8uY29weSgpLmFkZCh0aGlzLmFuZ2xlUmFkcy5jb3B5KCkubXVsdCg0MCkpO1xuXG4gICAgLy9kcmF3IHRvIGZhciAob2ZmLXNjcmVlbikgZW5kXG4gICAgaWYgKFJheS5pc0RyYXdHaG9zdFJheSkge1xuICAgICAgc3Ryb2tlKDI1NSwgMjU1LCAyNTUsIDEwKTtcbiAgICAgIHN0cm9rZVdlaWdodCgwLjMpO1xuICAgICAgbGluZShvLngsIG8ueSwgdGhpcy5mYXJFbmQueCwgdGhpcy5mYXJFbmQueSk7XG4gICAgfVxuICAgIGNvbnN0IG5lYXJQdCA9IHRoaXMubmVhcmVzdEludGVyc2VjdGlvbigpO1xuICAgIGlmIChSYXkuaXNEcmF3UmF5VG9GaXJzdEludGVyc2VjdGlvbikge1xuICAgICAgaWYgKG5lYXJQdCkge1xuICAgICAgICBzdHJva2UoXCJ3aGl0ZVwiKTtcbiAgICAgICAgc3Ryb2tlV2VpZ2h0KDIpO1xuICAgICAgICB0aGlzLmRyYXdMaXRMaW5lU2VnbWVudChvLCBuZWFyUHQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChSYXkuaXNEcmF3SW50ZXJzZWN0aW9ucykge1xuICAgICAgZm9yIChsZXQgaVB0IG9mIHRoaXMuaW50ZXJzZWN0aW9uUG9pbnRzKSB7XG4gICAgICAgIGZpbGwoXCJncmF5XCIpO1xuICAgICAgICBjaXJjbGUoaVB0LngsIGlQdC55LCAyKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpcnN0ID0gdGhpcy5uZWFyZXN0SW50ZXJzZWN0aW9uKCk7XG4gICAgICBpZiAoZmlyc3QpIHtcbiAgICAgICAgZmlsbChcIndoaXRlXCIpO1xuICAgICAgICBjaXJjbGUoZmlyc3QueCwgZmlyc3QueSwgMik7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGNhblNlZVBvaW50KHRhcmdldDogcDUuVmVjdG9yKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbmVhcmVzdElzZWN0OiBwNS5WZWN0b3IgPSB0aGlzLm5lYXJlc3RJbnRlcnNlY3Rpb24oKTtcbiAgICBjb25zdCBkaXN0VG9UYXJnZXQgPSB0aGlzLm9yaWdpbi5kaXN0KHRhcmdldCk7XG4gICAgcmV0dXJuIG5lYXJlc3RJc2VjdCAmJiB0aGlzLm9yaWdpbi5kaXN0KG5lYXJlc3RJc2VjdCkgPCBkaXN0VG9UYXJnZXQ7XG4gIH1cbn1cbiIsImNsYXNzIFN0cnVjdHVyZSB7XG4gIHJhbmRvbUNvbG9yKCk6IHA1LkNvbG9yIHtcbiAgICByZXR1cm4gcmFuZG9tKFtcbiAgICAgIGNvbG9yKDI1MCwgMTA1LCAwKSxcbiAgICAgIGNvbG9yKDEwNSwgMjEwLCAyMzEpLFxuICAgICAgY29sb3IoMTY3LCAyMTksIDIxNiksXG4gICAgICBjb2xvcigyNDMsIDEzNCwgNDgpXG4gICAgXSk7XG4gIH1cbiAgaXNGaWxsZWRTaGFwZSA9IGZhbHNlO1xuICBjZW50ZXI6IHA1LlZlY3RvcjtcbiAgYWJzdHJhY3RWZXJ0aWNlczogcDUuVmVjdG9yW107XG4gIHdhbGxzOiBXYWxsW107XG4gIG1vdmVtZW50U3BlZWQ6IG51bWJlcjtcbiAgbXlDb2xvcjogcDUuQ29sb3I7XG4gIHJvdGF0aW9uOiBudW1iZXI7XG4gIHJvdGF0aW9uU3BlZWQ6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihjZW50ZXI6IHA1LlZlY3RvciwgcmFkaXVzOiBudW1iZXIsIG51bVNpZGVzOiBudW1iZXIpIHtcbiAgICB0aGlzLnJvdGF0aW9uID0gcmFuZG9tKFRXT19QSSk7XG4gICAgdGhpcy5teUNvbG9yID0gdGhpcy5yYW5kb21Db2xvcigpO1xuICAgIHRoaXMubW92ZW1lbnRTcGVlZCA9IC1yYW5kb20oMC4yLCAyKTtcbiAgICB0aGlzLnJvdGF0aW9uU3BlZWQgPSByYW5kb20oLTAuMDEsIDAuMDEpO1xuICAgIHRoaXMuYWJzdHJhY3RWZXJ0aWNlcyA9IHRoaXMuY3JlYXRlVmVydGljZXNGb3JTaGFwZVdpdGhOdW1TaWRlcyhcbiAgICAgIGNlbnRlcixcbiAgICAgIHJhZGl1cyxcbiAgICAgIG51bVNpZGVzXG4gICAgKTtcblxuICAgIHRoaXMud2FsbHMgPSB0aGlzLm1ha2VXYWxsc0Zyb21WZXJ0aWNlcyhcbiAgICAgIHRoaXMuYWJzdHJhY3RWZXJ0aWNlcyxcbiAgICAgIHRoaXMubXlDb2xvclxuICAgICk7XG4gIH1cblxuICBjcmVhdGVWZXJ0aWNlc0ZvclNoYXBlV2l0aE51bVNpZGVzKFxuICAgIGNlbnRlcjogcDUuVmVjdG9yLFxuICAgIHJhZGl1czogbnVtYmVyLFxuICAgIG51bVNpZGVzOiBudW1iZXJcbiAgKTogcDUuVmVjdG9yW10ge1xuICAgIGNvbnN0IHZlcnRpY2VzID0gW107XG4gICAgLy9zcGVjaWFsIGNhc2UgZm9yIHNpbmdsZSB3YWxsXG4gICAgaWYgKG51bVNpZGVzID09PSAxKSB7XG4gICAgICBsZXQgW2EsIGJdID0gdGhpcy5jcmVhdGVSYW5kb21MaW5lU2VnKCk7XG4gICAgICB2ZXJ0aWNlcy5wdXNoKGEpO1xuICAgICAgdmVydGljZXMucHVzaChiKTtcbiAgICAgIHRoaXMuY2VudGVyID0gYS5jb3B5KCkubGVycChiLCAwLjUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNlbnRlciA9IGNlbnRlci5jb3B5KCk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtU2lkZXM7IGkrKykge1xuICAgICAgICBjb25zdCBhbmdsZSA9IChpICogVFdPX1BJKSAvIG51bVNpZGVzO1xuICAgICAgICB2ZXJ0aWNlcy5wdXNoKFxuICAgICAgICAgIHA1LlZlY3Rvci5mcm9tQW5nbGUoYW5nbGUpXG4gICAgICAgICAgICAubXVsdChyYWRpdXMpXG4gICAgICAgICAgICAuYWRkKHRoaXMuY2VudGVyKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmVydGljZXM7XG4gIH1cbiAgbWFrZVdhbGxzRnJvbVZlcnRpY2VzKHZzOiBwNS5WZWN0b3JbXSwgbXlDb2xvcjogcDUuQ29sb3IpOiBXYWxsW10ge1xuICAgIGNvbnN0IHdhbGxzOiBXYWxsW10gPSBbXTtcbiAgICBpZiAodnMubGVuZ3RoID09PSAyKSB7XG4gICAgICBjb25zdCBzaW5nbGVXYWxsID0gbmV3IFdhbGwodnNbMF0sIHZzWzFdKTtcbiAgICAgIHNpbmdsZVdhbGwubXlDb2xvciA9IG15Q29sb3I7XG4gICAgICB3YWxscy5wdXNoKHNpbmdsZVdhbGwpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBudW1TaWRlcyA9IHZzLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtU2lkZXM7IGkrKykge1xuICAgICAgICBjb25zdCBhID0gdnNbaV07XG4gICAgICAgIGNvbnN0IGIgPSBpID09PSBudW1TaWRlcyAtIDEgPyB2c1swXSA6IHZzW2kgKyAxXTtcbiAgICAgICAgY29uc3Qgd2FsbCA9IG5ldyBXYWxsKGEsIGIpO1xuICAgICAgICB3YWxsLm15Q29sb3IgPSBteUNvbG9yO1xuICAgICAgICB3YWxscy5wdXNoKHdhbGwpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gd2FsbHM7XG4gIH1cbiAgY3JlYXRlUmFuZG9tTGluZVNlZygpOiBwNS5WZWN0b3JbXSB7XG4gICAgY29uc3QgcDEgPSByYW5kb21TY3JlZW5Qb3NpdGlvbigpO1xuICAgIGNvbnN0IHAyID0gcDEuY29weSgpLmFkZChwNS5WZWN0b3IucmFuZG9tMkQoKS5tdWx0KHJhbmRvbSg0MCwgNDAwKSkpO1xuICAgIHJldHVybiBbcDEsIHAyXTtcbiAgfVxuXG4gIHJvdGF0ZShhbmdsZVJhZDogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5yb3RhdGlvbiArPSBhbmdsZVJhZDtcbiAgICBjb25zdCByb3RhdGVkVmVydGljZXMgPSB0aGlzLmFic3RyYWN0VmVydGljZXMubWFwKHYgPT5cbiAgICAgIHJvdGF0ZVZlcnRleEFyb3VuZCh2LCB0aGlzLmNlbnRlciwgdGhpcy5yb3RhdGlvbilcbiAgICApO1xuXG4gICAgLy9yZW1ha2UgdGhlIHdhbGxzXG4gICAgdGhpcy53YWxscyA9IHRoaXMubWFrZVdhbGxzRnJvbVZlcnRpY2VzKHJvdGF0ZWRWZXJ0aWNlcywgdGhpcy5teUNvbG9yKTtcbiAgfVxuXG4gIHVwZGF0ZSgpIHtcbiAgICBsZXQgbW92ZUFtdDogbnVtYmVyID0gdGhpcy5tb3ZlbWVudFNwZWVkO1xuICAgIGlmICh0aGlzLmNlbnRlci54ICsgbW92ZUFtdCA8IDApIHtcbiAgICAgIG1vdmVBbXQgKz0gd2lkdGg7XG4gICAgfVxuICAgIHRoaXMuY2VudGVyLnggKz0gbW92ZUFtdDtcbiAgICAvL3JlbWFrZSB0aGUgd2FsbHNcbiAgICB0aGlzLndhbGxzID0gdGhpcy5tYWtlV2FsbHNGcm9tVmVydGljZXMoXG4gICAgICB0aGlzLmFic3RyYWN0VmVydGljZXMubWFwKHYgPT4gdi5hZGQoY3JlYXRlVmVjdG9yKG1vdmVBbXQsIDApKSksXG4gICAgICB0aGlzLm15Q29sb3JcbiAgICApO1xuXG4gICAgdGhpcy5yb3RhdGUodGhpcy5yb3RhdGlvblNwZWVkKTtcbiAgfVxuICBkcmF3KCkge1xuICAgIGZvciAobGV0IHdhbGwgb2YgdGhpcy53YWxscykge1xuICAgICAgd2FsbC5kcmF3KCk7XG4gICAgfVxuICAgIGNpcmNsZSh0aGlzLmNlbnRlci54LCB0aGlzLmNlbnRlci55LCA1KTtcbiAgICBpZiAodGhpcy5pc0ZpbGxlZFNoYXBlKSB7XG4gICAgICBiZWdpblNoYXBlKCk7XG4gICAgICBmb3IgKGxldCB3YWxsIG9mIHRoaXMud2FsbHMpIHtcbiAgICAgICAgZm9yIChsZXQgcHQgb2YgW3dhbGwuYSwgd2FsbC5iXSkge1xuICAgICAgICAgIHZlcnRleChwdC54LCBwdC55KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZW5kU2hhcGUoQ0xPU0UpO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBjcmVhdGVSYW5kb20oKSB7XG4gICAgY29uc3QgY2VudGVyID0gcmFuZG9tU2NyZWVuUG9zaXRpb24oKTtcbiAgICBjb25zdCBudW1TaWRlcyA9IHJhbmRvbShbMSwgMSwgMSwgMywgNCwgNSwgOF0pO1xuICAgIHJldHVybiBuZXcgU3RydWN0dXJlKGNlbnRlciwgcmFuZG9tKDIwLCByYW5kb20oMTAwLCAyMDApKSwgbnVtU2lkZXMpO1xuICB9XG59XG4iLCJmdW5jdGlvbiByZXBlYXQobnVtOiBudW1iZXIsIGZuOiAoaXg6IG51bWJlcikgPT4gdm9pZCkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IG51bTsgaSsrKSB7XG4gICAgZm4oaSk7XG4gIH1cbn1cbmZ1bmN0aW9uIHJhbmRvbVNjcmVlblBvc2l0aW9uKCk6IHA1LlZlY3RvciB7XG4gIHJldHVybiBjcmVhdGVWZWN0b3IocmFuZG9tKHdpZHRoKSwgcmFuZG9tKGhlaWdodCkpO1xufVxuXG5mdW5jdGlvbiByYW5kb21JbnQobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcbiAgcmV0dXJuIHJvdW5kKHJhbmRvbShtaW4sIG1heCkpO1xufVxuXG5mdW5jdGlvbiB0cmFuc2xhdGVUb1ZlYyhwb3M6IHA1LlZlY3Rvcik6IHZvaWQge1xuICB0cmFuc2xhdGUocG9zLngsIHBvcy55KTtcbn1cblxuZnVuY3Rpb24gY2VudGVyUG9zKCk6IHA1LlZlY3RvciB7XG4gIHJldHVybiBjcmVhdGVWZWN0b3Iod2lkdGggLyAyLCBoZWlnaHQgLyAyKTtcbn1cbmZ1bmN0aW9uIHJvdGF0ZVZlcnRleEFyb3VuZChcbiAgdmVydGV4OiBwNS5WZWN0b3IsXG4gIHJvdE9yaWdpbjogcDUuVmVjdG9yLFxuICBhbmdsZVJhZDogbnVtYmVyXG4pOiBwNS5WZWN0b3Ige1xuICByZXR1cm4gdmVydGV4XG4gICAgLmNvcHkoKVxuICAgIC5zdWIocm90T3JpZ2luKVxuICAgIC5yb3RhdGUoYW5nbGVSYWQpXG4gICAgLmFkZChyb3RPcmlnaW4pO1xufVxuXG4vL1Rha2VuIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2Jtb3Jlbi9wNS5jb2xsaWRlMkRcbmZ1bmN0aW9uIGNvbGxpZGVMaW5lTGluZShcbiAgeDE6IG51bWJlcixcbiAgeTE6IG51bWJlcixcbiAgeDI6IG51bWJlcixcbiAgeTI6IG51bWJlcixcbiAgeDM6IG51bWJlcixcbiAgeTM6IG51bWJlcixcbiAgeDQ6IG51bWJlcixcbiAgeTQ6IG51bWJlclxuKSB7XG4gIC8vIGNhbGN1bGF0ZSB0aGUgZGlzdGFuY2UgdG8gaW50ZXJzZWN0aW9uIHBvaW50XG4gIGxldCB1QSA9XG4gICAgKCh4NCAtIHgzKSAqICh5MSAtIHkzKSAtICh5NCAtIHkzKSAqICh4MSAtIHgzKSkgL1xuICAgICgoeTQgLSB5MykgKiAoeDIgLSB4MSkgLSAoeDQgLSB4MykgKiAoeTIgLSB5MSkpO1xuICBsZXQgdUIgPVxuICAgICgoeDIgLSB4MSkgKiAoeTEgLSB5MykgLSAoeTIgLSB5MSkgKiAoeDEgLSB4MykpIC9cbiAgICAoKHk0IC0geTMpICogKHgyIC0geDEpIC0gKHg0IC0geDMpICogKHkyIC0geTEpKTtcblxuICAvLyBpZiB1QSBhbmQgdUIgYXJlIGJldHdlZW4gMC0xLCBsaW5lcyBhcmUgY29sbGlkaW5nXG4gIGlmICh1QSA+PSAwICYmIHVBIDw9IDEgJiYgdUIgPj0gMCAmJiB1QiA8PSAxKSB7XG4gICAgLy8gY2FsYyB0aGUgcG9pbnQgd2hlcmUgdGhlIGxpbmVzIG1lZXRcbiAgICBsZXQgaW50ZXJzZWN0aW9uWCA9IHgxICsgdUEgKiAoeDIgLSB4MSk7XG4gICAgbGV0IGludGVyc2VjdGlvblkgPSB5MSArIHVBICogKHkyIC0geTEpO1xuXG4gICAgcmV0dXJuIGNyZWF0ZVZlY3RvcihpbnRlcnNlY3Rpb25YLCBpbnRlcnNlY3Rpb25ZKTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gbWluQnk8VD4obGlzdDogVFtdLCBmbjogKGl0ZW06IFQpID0+IG51bWJlcik6IFQge1xuICBpZiAobGlzdC5sZW5ndGggPCAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgbGV0IHJlY29yZEl0ZW0gPSBsaXN0WzBdO1xuICBsZXQgcmVjb3JkV2VpZ2h0ID0gZm4obGlzdFswXSk7XG4gIGZvciAobGV0IGl0ZW0gb2YgbGlzdCkge1xuICAgIGNvbnN0IHdlaWdodCA9IGZuKGl0ZW0pO1xuICAgIGlmICh3ZWlnaHQgPiByZWNvcmRXZWlnaHQpIHtcbiAgICAgIHJlY29yZFdlaWdodCA9IHdlaWdodDtcbiAgICAgIHJlY29yZEl0ZW0gPSBpdGVtO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVjb3JkSXRlbTtcbn1cblxuZnVuY3Rpb24gZGlzdHJpYnV0ZVVwVG8odG90YWw6IG51bWJlciwgbWF4OiBudW1iZXIsIGZuOiAodjogbnVtYmVyKSA9PiB2b2lkKSB7XG4gIHJlcGVhdCh0b3RhbCwgaXggPT4ge1xuICAgIGNvbnN0IHZhbCA9IChpeCAqIG1heCkgLyB0b3RhbDtcbiAgICBmbih2YWwpO1xuICB9KTtcbn1cbiIsImNsYXNzIFdhbGwge1xuICBhOiBwNS5WZWN0b3I7XG4gIGI6IHA1LlZlY3RvcjtcblxuICBteUNvbG9yOiBwNS5Db2xvcjtcblxuICBjb25zdHJ1Y3RvcihhOiBwNS5WZWN0b3IsIGI6IHA1LlZlY3Rvcikge1xuICAgIHRoaXMuYSA9IGEuY29weSgpO1xuICAgIHRoaXMuYiA9IGIuY29weSgpO1xuICAgIHRoaXMubXlDb2xvciA9IGNvbG9yKDI0MywgMTM0LCA0OCk7XG4gIH1cbiAgZHJhdygpIHtcbiAgICBzdHJva2UodGhpcy5teUNvbG9yKTtcbiAgICBzdHJva2VXZWlnaHQoNCk7XG4gICAgbGluZSh0aGlzLmEueCwgdGhpcy5hLnksIHRoaXMuYi54LCB0aGlzLmIueSk7XG5cbiAgICBub1N0cm9rZSgpO1xuICAgIGZpbGwodGhpcy5teUNvbG9yKTtcbiAgICBbdGhpcy5hLCB0aGlzLmJdLmZvckVhY2gocHQgPT4ge1xuICAgICAgY2lyY2xlKHB0LngsIHB0LnksIDUpO1xuICAgIH0pO1xuICB9XG4gIG1pZFBvaW50KCk6IHA1LlZlY3RvciB7XG4gICAgcmV0dXJuIHRoaXMuYS5jb3B5KCkubGVycCh0aGlzLmIsIDAuNSk7XG4gIH1cblxuICBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gZGlzdCh0aGlzLmEueCwgdGhpcy5hLnksIHRoaXMuYi54LCB0aGlzLmIueSk7XG4gIH1cblxuICB0cmFuc2xhdGUob2Zmc2V0OiBwNS5WZWN0b3IpIHtcbiAgICBmb3IgKGxldCBwdCBvZiBbdGhpcy5hLCB0aGlzLmJdKSB7XG4gICAgICBwdC54ICs9IG9mZnNldC54O1xuICAgICAgcHQueSArPSBvZmZzZXQueTtcbiAgICB9XG4gIH1cbiAgc3RhdGljIGNyZWF0ZVJhbmRvbSgpIHtcbiAgICBjb25zdCBwMSA9IHJhbmRvbVNjcmVlblBvc2l0aW9uKCk7XG4gICAgY29uc3QgcDIgPSBwMS5jb3B5KCkuYWRkKHA1LlZlY3Rvci5yYW5kb20yRCgpLm11bHQocmFuZG9tKDQwLCA0MDApKSk7XG4gICAgcmV0dXJuIG5ldyBXYWxsKHAxLCBwMik7XG4gIH1cbn1cbiJdfQ==